<!doctype html>
<html lang="en">

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <!--<link rel="icon" href="img/favicon.ico">-->

    <link rel="apple-touch-icon" sizes="180x180" href="img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="img/favicon/favicon-16x16.png">


    <title>Airfares tracker</title>

    <!-- ****************************************************************** -->
    <!-- ****************************  CSS  ******************************* -->
    <!-- ****************************************************************** -->

    <!-- Bootstrap -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.0-alpha1/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.21/css/dataTables.bootstrap4.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" type="text/css" href="css/custom.css">




    <!-- ********************************************************************************* -->
    <!-- ****************************  CSS | ICONS, LOGOS  ******************************* -->
    <!-- ********************************************************************************* -->

    <!-- Flags library -->
    <!--<link rel="stylesheet" type="text/css" href="https://github.com/downloads/lafeber/world-flags-sprite/flags32.css">-->

    <!-- Vector icons and social logos | https://fontawesome.com/icons?d=gallery&m=free -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css">

    <!-- ****************************************************************** -->
    <!-- ****************************  JS  ******************************** -->
    <!-- ****************************************************************** -->

    <!-- jQuery -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>

    <!-- AWS SDK -->
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.7.16.min.js"></script>

    <!-- dataTables -->
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.21/js/dataTables.bootstrap4.min.js"></script>



    <!-- Script Bootstrap 4.0 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

    <!-- Black pop-ups containing comments and feedbacks when hovering -->
    <!--<script src="bootstrap-4.0.0/dist/js/bootstrap-select.min.js"></script>
<script src="js/jquery/jquery-ui.js" type="text/javascript"></script>
<script src="js/jquery/jquery.tablesorter.js"></script>-->



    <!-- Required to display buttons (Copy, Excel, PDF) 
    <script type="text/javascript" src="js/datatables/dataTables.buttons.min.js"></script>
    <script type="text/javascript" src="js/jszip.min.js"></script>
    <script type="text/javascript" src="js/pdfmake.min.js"></script>
    <script type="text/javascript" src="js/vfs_fonts.js"></script>
    <script type="text/javascript" src="js/buttons.html5.min.js"></script>-->


</head>

<body>
    <nav class="navbar navbar-expand-md navbar-dark fixed-top">
        <!-- bg-dark -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <div style="position: absolute; z-index:1000; top: 0.5em; left:1em"><img height="60em" src="img/pilot17.png" /></div>
        <!--<div class="paneHeader">C</div>
        <div class="paneHeader">o</div>
        <div class="paneHeader">m</div>
        <div class="paneHeader">a</div>
        <div class="paneHeader">n</div>
        <div class="paneHeader">d</div>
        <div class="paneHeader">a</div>
        <div class="paneHeader">n</div>
        <div class="paneHeader">t</div>
        <div class="paneHeader">e</div>
        <div class="paneHeader">7</div>
        <div class="paneHeader">&nbsp;</div>
        <div class="paneHeader">|</div>-->
        <div class="paneHeader">&nbsp;</div>
        <div class="paneHeader">A</div>
        <div class="paneHeader">i</div>
        <div class="paneHeader">r</div>
        <div class="paneHeader">f</div>
        <div class="paneHeader">a</div>
        <div class="paneHeader">r</div>
        <div class="paneHeader">e</div>
        <div class="paneHeader">s</div>
        <div class="paneHeader">&nbsp;</div>
        <div class="paneHeader">t</div>
        <div class="paneHeader">r</div>
        <div class="paneHeader">a</div>
        <div class="paneHeader">c</div>
        <div class="paneHeader">k</div>
        <div class="paneHeader">e</div>
        <div class="paneHeader">r</div>
        <div class="paneHeader">&nbsp;</div>&nbsp;&nbsp;
        <!--<div class="paneHeader">&#9992</div>-->


        <!--<a class="navbar-brand" href="#">Risk Mngmt.</a>-->
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

        <div class="collapse navbar-collapse" id="navbarsExampleDefault">
            <ul class="navbar-nav mr-auto">
                <!--<li class="nav-item">
                    <a class="nav-link" href="d3_line_chart_json_sydney_adelaide.html">Line chart | Trends</a>
                </li>
                &nbsp;&nbsp;
                <li class="nav-item">
                    <a class="nav-link" href="d3_line_chart_json_min_airfares_only.html">Line chart (min airfares only)</a>
                </li>-->
            </ul>


        </div>
    </nav>


    <br/><br/><br/>

    <!-- table-hover table-sm table-dark-->
    <div style="width:99%; padding-left:1em;">
        <table id="example" class="display table table-striped table-borderless" width="100%"></table>
    </div>

    <!-- ****************************************************************** -->
    <!-- **************** LOAD EXTERNAL JSON FILE ************************* -->
    <!-- ****************************************************************** -->
    <!-- <script type="text/javascript" src="C:\Users\Seb\Desktop\data_tables_no_server_required\data\json_data.js"></script> -->

    <!--<script type="text/javascript" src="data/json_data_objects_alteryx_format_2.js"></script>-->

    <script>
        /* Formatting function for row details - modify as you need */
        function format(d) {
            var rowsSubArray = '';
            // Number of sub-rows to display
            for (var k in d.milestones) {
                //console.log(k, result[k]);
                rowsSubArray += '<tr>' +
                    '<td class="">' + d.milestones[k].id_milestone + '</td>' +
                    '<td class="">' + d.milestones[k].milestone + '</td>' +
                    '<td class="">' + d.milestones[k].business_impact + '</td>' +
                    '<td class="">' + d.milestones[k].start_date + '</td>' +
                    '<td class="">' + d.milestones[k].due_date + '</td>' +
                    '<td class="">' + d.milestones[k].owner + '</td>' +
                    '<td class="">' + d.milestones[k].celebration_point + '</td>' +
                    '</tr>';
            }

            // `d` is the original data object for the row
            return '<table class="table-sm table-borderless table-striped-sub-array subarray" cellpadding="3" cellspacing="0" border="0" style="padding-left:10em;">' +
                '<tr>' +
                '<thead class="subarray"><th class="">ID</th><th class="">Name</th><th class="">Impact</th><th class="">Start date</th><th class="">Due date</th><th class="">Owner</th><th class="">Comments</th></thead>' +
                rowsSubArray +
                '</table>';
            //'<iframe src = "insert_gantt_chart.html" width = "1200px" height = "550px" seamless frameBorder = "0" scrolling = "no" > < /iframe>';


            ;
        }


        // ************************************************************
        // show popup to add Manager comment (Comment after Review)
        // ************************************************************
        function addCommentManager(comment) {
            $("#AddCommentManager").modal({
                show: true
            });



            //Encoding for Bootstrap modal pop-up --> HTML to JS			
            /*var comment = comment.replace(/<br\s*\/?>/mg, "\n");
            var comment = comment.replace(/&#039;/mg, "'");
            var comment = comment.replace(/&amp;/mg, "&");
            var comment = comment.replace(/&lt;/mg, "<");
            var comment = comment.replace(/&gt;/mg, ">");
            var comment = comment.replace(/&quot;/mg, '"');*/

            //Assign value to field			
            //$(".modal-body #commentManager").val(comment);

            // Focus on textarea inside a modal on click
            /*$('#AddCommentManager').on('shown.bs.modal', function() {
                $('#commentManager').focus();
            })*/
        }




        // table initialisation (for Objects)
        $(document).ready(function() {
            $('#example').DataTable({
                //"dom": '<lf<t>ip>',            // "dom": 'lrtip'
                "dom": "<'row'<'col-sm-12 col-md-6'B><'col-sm-12 col-md-6'>>" +
                    "<'row'<'col-sm-12 col-md-6'l><'col-sm-12 col-md-6'f>>" +
                    "<'row'<'col-sm-12'tr>>" +
                    "<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
                buttons: [
                    //'copyHtml5',
                    //'excelHtml5',
                    //'csvHtml5',
                    //'pdfHtml5'
                ],
                "order": [
                    [4, "desc"],
                    [2, "asc"],
                ],
                paging: true,
                //scrollY: 400,
                "pageLength": 25, // Amount of rows displayed per page
                //select: "os", // select using CTRL or SHIFT
                "ajax": {
                    "url": "data/airfaresSydneyAdelaideSmall.json",
                    "dataSrc": ""
                },
                "pagingType": "full_numbers",
                deferRender: true,
                columnDefs: [{
                    targets: -1,
                    className: 'dt-body-center',
                }, {
                    "width": "5%",
                    "targets": 3 // width of 4th column
                }],
                columns: [{
                        title: '#',
                        "className": 'details-control',
                        "orderable": false,
                        "data": null,
                        "defaultContent": '',
                        render: function() {
                            return '<i class="fa fa-plus-square" style="color:rgba(var(--main-color-1), 1);"></i>'
                        }
                    }, {
                        title: 'Provider',
                        data: 'provider',
                        render: function(data, type, full) {
                            //return '<i class="fas fa-tasks" style="color:#E91E63;"></i>'
                            //https://getbootstrap.com/docs/4.0/components/progress/
                            var backgroundColorProvider = '#01579B';
                            if (data.toLowerCase().includes("jetstar")) {
                                backgroundColorProvider = '#f74f1a';
                            } else if (data.toLowerCase().includes("qantas")) {
                                backgroundColorProvider = '#d92121';
                            } else if (data.toLowerCase().includes("gotogate")) {
                                backgroundColorProvider = '#165885';
                            } else if (data.toLowerCase().includes("tripmonster")) {
                                backgroundColorProvider = '#7e2a8a';
                            } else if (data.toLowerCase().includes("edreams")) {
                                backgroundColorProvider = '#003497';
                            } else if (data.toLowerCase().includes("aunt betty")) {
                                backgroundColorProvider = '#e25938';
                            } else if (data.toLowerCase().includes("kiwi")) {
                                backgroundColorProvider = '#33a991';
                            } else if (data.toLowerCase().includes("hacker fare")) {
                                backgroundColorProvider = '#000';
                            } else if (data.toLowerCase().includes("kayak")) {
                                backgroundColorProvider = '#f2501a';
                            } else {
                                backgroundColorProvider = '#01579B';
                            }
                            return '<div class="progress"><div class="progress-bar" role="progressbar" style="width: 100%; background-color:' + backgroundColorProvider + '" data-toggle="tooltip" title="Provider name">' + data + '</div></div>';
                        }
                    }, {
                        title: 'Airfare',
                        data: 'price',
                        "orderable": true,
                        "className": 'dt-body-center',
                        render: function(data) {
                            //Encoding for tooltip pop-up --> JS to HTML
                            var data = data.replace(/(?:\r\n|\r|\n)/g, '<br/>'); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up	
                            data = data.replace(/(?:')/g, "&#039;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up			
                            data = data.replace(/(?:&)/g, "&amp;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up								
                            data = data.replace(/(?:<)/g, "&lt;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up								
                            data = data.replace(/(?:>)/g, "&gt;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up								
                            data = data.replace(/(?:")/g, "&quot;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up															

                            //return '<button data-toggle="tooltip" style="background: transparent !important; border:none !important;" data-html="true" title="' + data + '" onclick="addTagging(\'' + data + '\')"><small class="text-muted"><span class="fas fa-comment fa-lg" style="color: rgba(var(--main-color-1),1)"></span></small></button>';
                            //return data.substr(0, 50) + "...";
                            if (data.length > 45) {
                                return data.substr(0, 45) + '...' + '' + '<button data-toggle="tooltip" style="background: transparent !important; border:none !important;" data-html="true" title="' + data + '" onclick="addTagging(\'' + data + '\')"><small class="text-muted"><span class="fas fa-plus-circle fa-lg" style="color: rgba(var(--main-color-1),1)"></span></small></button>';
                            } else {
                                return data;
                            }




                            //return data.substr(0, 10) + "...";
                        }
                    }, {
                        title: 'Query',
                        data: 'searched_on',
                        render: function(data, type, row, meta) {
                            var dayOfTheWeek = 'N/A';
                            var time = 'N/A';
                            if (typeof data != "undefined") {
                                var date = new Date(data);
                                var n = date.getDay();

                                time = date.getHours() + ':' + date.getMinutes();

                                var day = new Array();
                                day[0] = "Sun.";
                                day[1] = "Mon.";
                                day[2] = "Tue.";
                                day[3] = "Wed.";
                                day[4] = "Thu.";
                                day[5] = "Fri.";
                                day[6] = "Sat.";
                                //dayOfTheWeek = day[n] + ' @ ' + time;
                                dayOfTheWeek = day[n];

                            } else {
                                dayOfTheWeek = '-';
                                time = '-';
                            }
                            //var date = new Date(data);
                            //var n = date.getDay();


                            return dayOfTheWeek;
                        }
                    }, {
                        title: 'Query (UTC)',
                        data: 'searched_on',
                        render: function(data) {

                            var searchedOn = '';
                            if (typeof data != "undefined") {

                                var date = new Date(data); // M-D-YYYY

                                var d = date.getDate();
                                var m = date.getMonth();
                                var y = date.getFullYear();

                                //var d = new Date();
                                var month = new Array();
                                month[0] = "Jan";
                                month[1] = "Feb";
                                month[2] = "Mar";
                                month[3] = "Apr";
                                month[4] = "May";
                                month[5] = "Jun";
                                month[6] = "Jul";
                                month[7] = "Aug";
                                month[8] = "Sep";
                                month[9] = "Oct";
                                month[10] = "Nov";
                                month[11] = "Dec";
                                var n = month[m];
                                //searchedOn = n + ' ' + d + ', ' + y;
                                searchedOn = data;
                            } else {
                                searchedOn = '-';
                            }


                            return searchedOn;
                            //return start_date;
                        }
                    }, {
                        title: 'Departure',
                        data: 'departure',
                        render: function(data, type, full) {

                            var div = '';
                            var s = data;
                            for (var i = 0; i < s.length; i++) {
                                //console.log(s.charAt(i));
                                div += '<div class="pane">' + s.charAt(i) + '</div>';
                            }
                            //return '<i class="fas fa-tasks" style="color:#E91E63;"></i>'
                            //https://getbootstrap.com/docs/4.0/components/progress/
                            //return '<div class="pane">S</div><div class="pane">y</div><div class="pane">d</div><div class="pane">n</div><div class="pane">e</div><div class="pane">y</div>';
                            //return '<div class="">' + data + '</div>';
                            return div;
                        }
                    }, {
                        title: 'Destination',
                        data: 'destination',
                        render: function(data, type, full) {
                            var div = '';
                            var s = data;
                            for (var i = 0; i < s.length; i++) {
                                //console.log(s.charAt(i));
                                div += '<div class="pane">' + s.charAt(i) + '</div>';
                            }

                            //return '<i class="fas fa-tasks" style="color:#E91E63;"></i>'
                            //https://getbootstrap.com/docs/4.0/components/progress/
                            //return '<div class="pane">S</div><div class="pane">i</div><div class="pane">o</div><div class="pane">n</div>';
                            //return '<div class="">' + data + '</div>';
                            return div;

                        }
                    }, {
                        title: 'Departure',
                        data: 'departure_date',
                        render: function(data) {


                            var date = new Date(data); // M-D-YYYY

                            var d = date.getDate();
                            var m = date.getMonth();
                            var y = date.getFullYear();

                            //var d = new Date();
                            var month = new Array();
                            month[0] = "Jan";
                            month[1] = "Feb";
                            month[2] = "Mar";
                            month[3] = "Apr";
                            month[4] = "May";
                            month[5] = "Jun";
                            month[6] = "Jul";
                            month[7] = "Aug";
                            month[8] = "Sep";
                            month[9] = "Oct";
                            month[10] = "Nov";
                            month[11] = "Dec";
                            var n = month[m];

                            //return n + ' ' + d + ', ' + y;
                            return data;
                        }
                    }
                    /*, {
                                            title: 'Stopovers',
                                            data: 'price',
                                            render: function(data, type, full) {
                                                //return '<i class="fas fa-tasks" style="color:#E91E63;"></i>'
                                                //https://getbootstrap.com/docs/4.0/components/progress/
                                                //return '<span class="fa-stack"><span class="fas fa-circle fa-stack-1x" style="color: #607D8B"></span><strong class="fa-stack-1x" style="color: rgba(var(--main-color-white),1)">TBD</strong></span>';
                                                return 'tbd';
                                            }
                                        }*/
                    , {
                        title: 'Arrival',
                        data: 'arrival_date',
                        render: function(data) {



                            var date = new Date(data); // M-D-YYYY

                            var d = date.getDate();
                            var m = date.getMonth() + 1;
                            var y = date.getFullYear();

                            //var d = new Date();
                            var month = new Array();
                            month[0] = "Jan";
                            month[1] = "Feb";
                            month[2] = "Mar";
                            month[3] = "Apr";
                            month[4] = "May";
                            month[5] = "Jun";
                            month[6] = "Jul";
                            month[7] = "Aug";
                            month[8] = "Sep";
                            month[9] = "Oct";
                            month[10] = "Nov";
                            month[11] = "Dec";
                            var n = month[m];

                            //return n + ' ' + d + ', ' + y;
                            return data;
                        }
                    }, {
                        title: 'Days to departure',
                        data: 'departure_date',
                        render: function(data) {

                            var daysToDeparture = 0;
                            //var start_date = '';
                            var departure_date = data;

                            today = new Date();
                            // To calculate Today's date
                            var todayDate = new Date(today.getFullYear(), today.getMonth(), today.getDate()); // today


                            // To set two dates to two variables 
                            var date1 = new Date(todayDate); // today
                            var date2 = new Date(departure_date); // delivery date     
                            // To calculate the time difference of two dates 
                            var project_length_difference_in_time = date1.getTime() - date2.getTime();
                            // To calculate the no. of days between two dates 
                            var project_length_difference_in_days = project_length_difference_in_time / (1000 * 3600 * 24);



                            //var progress = 0;
                            //var project_progression_difference_in_days = 0;
                            if (date2 <= date1) {
                                percentage_already_completed = 100;
                                daysToDeparture = 0;
                            } else {
                                daysToDeparture = project_length_difference_in_days;
                                // To calculate the time difference between today and the end of the project 
                                //var project_progression_difference_in_time = todayDate.getTime() - date2.getTime();
                                // To calculate the no. of days between today and the end of the project 
                                //var project_progression_difference_in_days = project_progression_difference_in_time / (1000 * 3600 * 24);

                                //percentage_until_completion = project_progression_difference_in_days / project_length_difference_in_days; // e.g. 0.74
                                //percentage_already_completed = 1 - percentage_until_completion;
                            }

                            //return '<progress style="background-color:#CDDC39" value="' + percentage_already_completed * 100 + '" max="100">' + (percentage_already_completed * 100) + '</progress>';
                            //return '<div class="progress"><div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="' + Math.round(percentage_already_completed * 100) + '" aria-valuemin="0" aria-valuemax="100" style="width:' + Math.round(percentage_already_completed * 100) + '%">' + Math.round(percentage_already_completed * 100) + '% completed</div></div>';
                            return Math.abs(Math.round(daysToDeparture, 0));
                            /*return type === 'display' ?
                                '<progress value="50" max="100"></progress>' :
                                data;*/
                        }
                    }, {
                        title: 'Buy or wait',
                        data: 'delivery_date',
                        render: function(data, type, row, meta) {
                            return '<span  data-toggle="tooltip" title="on time" class="fas fa-circle fa-lg" style="color: rgba(var(--main-color-green),1)"></span><span  data-toggle="tooltip" title="on time" class="fas fa-circle fa-lg" style="color: rgba(var(--main-color-red-light),1)"></span>';
                        }
                    }
                    /*, {
                                            title: 'Objective',
                                            data: 'objective',
                                            "orderable": false,
                                            //"className": 'justifyContent',
                                            render: function(data) {
                                                //Encoding for tooltip pop-up --> JS to HTML
                                                var data = data.replace(/(?:\r\n|\r|\n)/g, '<br/>'); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up	
                                                data = data.replace(/(?:')/g, "&#039;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up			
                                                data = data.replace(/(?:&)/g, "&amp;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up								
                                                data = data.replace(/(?:<)/g, "&lt;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up								
                                                data = data.replace(/(?:>)/g, "&gt;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up								
                                                data = data.replace(/(?:")/g, "&quot;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up															

                                                return '<button data-toggle="tooltip" style="background: transparent !important; border:none !important;" data-html="true" title="' + data + '" onclick="addTagging(\'' + data + '\')"><small class="text-muted"><span class="fas fa-comment fa-lg" style="color: rgba(var(--main-color-1),1)"></span></small></button>';
                                                //return data.substr(0, 10) + "...";
                                            }
                                        }, {
                                            title: 'Success',
                                            data: 'success_measures',
                                            "orderable": false,
                                            //"className": 'justifyContent',
                                            render: function(data) {
                                                //Encoding for tooltip pop-up --> JS to HTML
                                                var data = data.replace(/(?:\r\n|\r|\n)/g, '<br/>'); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up	
                                                data = data.replace(/(?:')/g, "&#039;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up			
                                                data = data.replace(/(?:&)/g, "&amp;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up								
                                                data = data.replace(/(?:<)/g, "&lt;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up								
                                                data = data.replace(/(?:>)/g, "&gt;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up								
                                                data = data.replace(/(?:")/g, "&quot;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up															

                                                return '<button data-toggle="tooltip" style="background: transparent !important; border:none !important;" data-html="true" title="' + data + '" onclick="addTagging(\'' + data + '\')"><small class="text-muted"><span class="fas fa-comment fa-lg" style="color: rgba(var(--main-color-1),1)"></span></small></button>';
                                                //return data.substr(0, 10) + "...";
                                            }
                                        }, {
                                            title: 'Deliverable',
                                            data: 'deliverables',
                                            "orderable": false,
                                            //"className": 'justifyContent',
                                            render: function(data) {

                                                //Encoding for tooltip pop-up --> JS to HTML
                                                var data = data.replace(/(?:\r\n|\r|\n)/g, '<br/>'); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up	
                                                data = data.replace(/(?:')/g, "&#039;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up			
                                                data = data.replace(/(?:&)/g, "&amp;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up								
                                                data = data.replace(/(?:<)/g, "&lt;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up								
                                                data = data.replace(/(?:>)/g, "&gt;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up								
                                                data = data.replace(/(?:")/g, "&quot;"); // replace return carriages/new line by HTML tag <br/>	for tooltip pop-up															

                                                return '<button data-toggle="tooltip" style="background: transparent !important; border:none !important;" data-html="true" title="' + data + '" onclick="addTagging(\'' + data + '\')"><small class="text-muted"><span class="fas fa-comment fa-lg" style="color: rgba(var(--main-color-1),1)"></span></small></button>';
                                                //return data.substr(0, 10) + "...";
                                            }
                                        }*/
                    , {
                        title: 'Predictions',
                        data: 'milestones',
                        className: 'dt-body-center',
                        render: function(data) {

                            var mil = '<div>';
                            // Milestone #
                            var count = 1;

                            // Loop through all the milestones belonging to an project
                            for (var k in data) {
                                mil += '<div style="float:left; position: relative">';

                                // Add celebration star when necessary
                                var celebrationSpan = '';
                                if (data[k].celebration_point.toLowerCase() == 'yes' || data[k].celebration_point.toLowerCase() == 'y') {
                                    celebrationSpan = '<div style="position: absolute; top:-0.4em; right:0"><i data-toggle="tooltip" title="Celebrate!" class="fas fa-star fa-xs" style="color:rgba(var(--main-color-star),1)"></i></div>';
                                } else {
                                    celebrationSpan = '';
                                }

                                // Pick colour (whether the milestone impacts the business or not)
                                var colorCircle = '';
                                var tooltipBusinessImpact = '';
                                if (data[k].business_impact.toLowerCase() == 'y' || data[k].business_impact.toLowerCase() == 'yes') {
                                    colorCircle = 'rgba(var(--main-color-2),1)';
                                    tooltipBusinessImpact = 'data-toggle="tooltip" title="Business impact!"';
                                } else {
                                    colorCircle = 'rgba(var(--main-color-1),1)';
                                }

                                // Cercles containing milestone #, cercle's colour and star (when applicable)
                                mil += '<span ' + tooltipBusinessImpact + ' class="fa-stack"><span class="fas fa-circle fa-stack-2x" style="color: ' + colorCircle + '"></span><strong class="fa-stack-1x" style="color: rgba(var(--main-color-white),1)">' + count + '</strong></span>' + celebrationSpan;

                                mil += '</div>';

                                // Increment the milestone #
                                count += 1;
                            }
                            mil += '</div>';


                            return '<img src="img/10377-woman-pilot-light-skin-tone-icon.png"/> Deal!';
                        }
                    }
                ]


            });

            // *************************************************************
            // Add event listener for opening and closing details
            // *************************************************************	
            $('#example tbody').on('click', 'td.details-control', function() {
                var table = $("#example").DataTable();

                var tr = $(this).closest('tr');
                var row = table.row(tr);
                var tdi = tr.find("i.fa");

                if (row.child.isShown()) {
                    // This row is already open - close it
                    row.child.hide();
                    tr.removeClass('shown');
                    tdi.first().removeClass('fa-minus-square');
                    tdi.first().addClass('fa-plus-square');
                } else {
                    // Open this row
                    row.child(format(row.data())).show();
                    tr.addClass('shown');
                    tdi.first().removeClass('fa-plus-square');
                    tdi.first().addClass('fa-minus-square');
                }
            });



            // ************************************************************
            // Add toggle /tooltip | doesn't work so far
            // ************************************************************
            /*$("#example tbody").on("draw.dt", function() {
                $("[data-toggle='tooltip']").tooltip({
                    placement: 'left',
                    trigger: "hover"
                }); // tooltip to the left (blinking phenomenon otherwise) and displayed when hover only
            });*/




        });





        // ************************************************************
        // show popup to add tagging 
        // ************************************************************
        function addTagging(comment) {
            $("#AddTagging").modal({
                show: true
            }); // {backdrop: 'static', keyboard: false, show: true} Cannot escape the windows unless the user clicks on cancel

            //Encoding for Bootstrap modal pop-up --> HTML to JS			
            var comment = comment.replace(/<br\s*\/?>/mg, "\n");
            var comment = comment.replace(/&#039;/mg, "'");
            var comment = comment.replace(/&amp;/mg, "&");
            var comment = comment.replace(/&lt;/mg, "<");
            var comment = comment.replace(/&gt;/mg, ">");
            var comment = comment.replace(/&quot;/mg, '"');

            //Assign value to field			
            $(".modal-body #tagging").val(comment);

            // Focus on textarea inside a modal on click
            $('#AddTagging').on('shown.bs.modal', function() {
                $('#tagging').focus();
            })
        }
    </script>


    <script>
        // Black tooltip when hovering
        $(document).ready(function() {
            $('[data-toggle="tooltip"]').tooltip({
                placement: 'left',
                trigger: "hover"
            });
        });
    </script>


</body>

</html>


<!-- *********************************************************************** -->
<!-- *********************************************************************** -->
<!-- ************* << POP-UP >> Comment Manager // After review --**************** -->
<!-- *********************************************************************** -->
<!-- *********************************************************************** -->
<div class="modal fade bd-example-modal-lg" id="AddCommentManager" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-body">
                <div class="form-row">
                    <label for="">Gantt chart&nbsp;&nbsp;<i class="fas fa-project-diagram"></i></label>
                    <!--<textarea class="md-textarea form-control" placeholder="" name="commentManager" title="commentManager" id="commentManager" rows="10"></textarea>-->
                    <iframe src="insert_gantt_chart.html" width="1200px" height="550px" seamless frameBorder="0" scrolling="no"></iframe>



                </div>
            </div>
            <div class="modal-footer">
                <!--<button type="button" class="btn btn-success" data-dismiss="modal" onclick="updateCommentAfterReview()" data-toggle="tooltip" align="left" style="float:left !important">Add</button>-->
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            </div>
        </div>
    </div>
</div>
</div>




<!-- *********************************************************************** -->
<!-- *********************************************************************** -->
<!-- ************* << POP-UP >> Tagging *************** -->
<!-- *********************************************************************** -->
<!-- *********************************************************************** -->
<div class="modal fade" id="AddTagging" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <form action="updateActions.php" method="post" id="form-tagging" target="hidden-frame">
                    <div class="form-row">
                        <div class="form-group col-md-12">
                            <label for="validationDefault01">Content&nbsp;&nbsp;<span class="fas fa-comment fa-lg" style="color: rgba(var(--main-color-1),1)"></span></label>
                            <textarea class="md-textarea form-control" placeholder="" name="tagging" title="tagging" id="tagging" rows="14"></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <!--<button type="button" class="btn btn-success" data-dismiss="modal" onclick="updateTagging()" data-toggle="tooltip" align="left" style="float:left !important">Add</button>-->
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            </div>
        </div>
    </div>
</div>